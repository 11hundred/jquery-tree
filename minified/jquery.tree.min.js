/*
 * tree - jQuery Tree Plugin - ajax component
 *
 * @author Valerio Galano <v.galano@daredevel.com>
 *
 * @license MIT
 *
 * @see http://tree.daredevel.com
 */
$.widget("daredevel.treeajax",{_create:function(){var a=this;if(this.options.dataSourceUrl){a._lazyInit()}if(this.options.dataSourceUrl){this.element.bind("treeexpand",function(c,b){if($(b).find("ul").length){return}a._lazyLoad($(b))})}if(this.options.dataEditUrl){this.element.bind("treemove",function(c,b){a._notifyMove($(b))})}this.options.core._treeajaxInitializeNode=function(b){a._initializeNode(b)}},_initializeNode:function(a){},_lazyInit:function(){var a=this;$.ajax({url:this.options.dataSourceUrl,dataType:"json",beforeSend:function(){},complete:function(){},data:{},success:function(b){$.each(b.nodes,function(c,d){a.options.core.addNode(d)})}})},_lazyLoad:function(a){var b=this;$.ajax({url:this.options.dataSourceUrl,dataType:"json",data:{node:a.attr("id")},success:function(c){$.each(c.nodes,function(d,e){b.options.core.addNode(e,a)})}})},_notifyMove:function(b){var c=this;var a=c.options.core.parentNode(b);$.ajax({url:this.options.dataEditUrl,dataType:"json",data:{node:b.attr("id"),operation:"move",parent:a.attr("id")},beforeSend:function(){alert("beforeSend")},success:function(d){alert("ok")}})},options:{dataEditUrl:"",dataSourceUrl:""}});
/*
 * tree - jQuery Tree Plugin - checkbox component
 *
 * @author Valerio Galano <v.galano@daredevel.com>
 *
 * @license MIT
 *
 * @see http://tree.daredevel.com
 */
$.widget("daredevel.treecheckbox",{_allDescendantChecked:function(a){return(a.find("li input:checkbox:not(:checked)").length==0)},_checkAncestors:function(a){a.parentsUntil(this.options.core.widgetBaseClass).filter("li").find("input:checkbox:first:not(:checked)").prop("checked",true).change()},_checkDescendants:function(a){a.find("li input:checkbox:not(:checked)").prop("checked",true).change()},_checkOthers:function(a){var b=this;a.addClass("exclude");a.parents("li").addClass("exclude");a.find("li").addClass("exclude");$(this.element).find("li").each(function(){if(!$(this).hasClass("exclude")){$(this).find("input:checkbox:first:not(:checked)").prop("checked",true).change()}});$(this.element).find("li").removeClass("exclude")},_create:function(){var a=this;this.element.find("input:checkbox:not(:checked)").live("click",function(){a.uncheck(a.options.core.parentNode($(this)))});this.element.find("input:checkbox:checked").live("click",function(){a.check(a.options.core.parentNode($(this)))});if(this.options.onUncheck.node=="collapse"){this.element.find("input:checkbox:not(:checked)").live("click",function(){a.options.core.collapse(a.options.core.parentNode($(this)))})}else{if(this.options.onUncheck.node=="expand"){this.element.find("input:checkbox:not(:checked)").live("click",function(){a.options.core.expand(a.options.core.parentNode($(this)))})}}if(this.options.onCheck.node=="collapse"){this.element.find("input:checkbox:checked").live("click",function(){a.options.core.collapse(a.options.core.parentNode($(this)))})}else{if(this.options.onCheck.node=="expand"){this.element.find("input:checkbox:checked").live("click",function(){a.options.core.expand(a.options.core.parentNode($(this)))})}}this.options.core.check=function(b){a.check(b)};this.options.core.checkAll=function(){a.checkAll()};this.options.core.uncheck=function(b){a.uncheck(b)};this.options.core.uncheckAll=function(){a.uncheckAll()};this.options.core._treecheckboxInitializeNode=function(b){a._initializeNode(b)}},_initializeNode:function(a){},_uncheckAncestors:function(a){a.parentsUntil(this.options.core.widgetBaseClass).filter("li").find("input:checkbox:first:checked").prop("checked",false).change()},_uncheckDescendants:function(a){a.find("li input:checkbox:checked").prop("checked",false).change()},_uncheckOthers:function(a){var b=this;a.addClass("exclude");a.parents("li").addClass("exclude");a.find("li").addClass("exclude");$(this.element).find("li").each(function(){if(!$(this).hasClass("exclude")){$(this).find("input:checkbox:first:checked").prop("checked",false).change()}});$(this.element).find("li").removeClass("exclude")},check:function(a){a=$(a);a.find("input:checkbox:first:not(:checked)").prop("checked",true).change();if(this.options.onCheck.others=="check"){this._checkOthers(a)}else{if(this.options.onCheck.others=="uncheck"){this._uncheckOthers(a)}}if(this.options.onCheck.descendants=="check"){this._checkDescendants(a)}else{if(this.options.onCheck.descendants=="uncheck"){this._uncheckDescendants(a)}}if(this.options.onCheck.ancestors=="check"){this._checkAncestors(a)}else{if(this.options.onCheck.ancestors=="uncheck"){this._uncheckAncestors(a)}else{if(this.options.onCheck.ancestors=="checkIfFull"){var b=this.options.core.isRoot(a);var c=this._allDescendantChecked(this.options.core.parentNode(a));if(!b&&c){this.check(this.options.core.parentNode(a))}}}}},checkAll:function(){$(this.element).find("input:checkbox:not(:checked)").prop("checked",true).change()},uncheck:function(a){a=$(a);a.find("input:checkbox:first:checked").prop("checked",false).change();if(this.options.onUncheck.others=="check"){this._checkOthers(a)}else{if(this.options.onUncheck.others=="uncheck"){this._uncheckOthers(a)}}if(this.options.onUncheck.descendants=="check"){this._checkDescendants(a)}else{if(this.options.onUncheck.descendants=="uncheck"){this._uncheckDescendants(a)}}if(this.options.onUncheck.ancestors=="check"){this._checkAncestors(a)}else{if(this.options.onUncheck.ancestors=="uncheck"){this._uncheckAncestors(a)}}},uncheckAll:function(){$(this.element).find("input:checkbox:checked").prop("checked",false).change()},options:{onCheck:{ancestors:"check",descendants:"check",node:"",others:""},onUncheck:{ancestors:"",descendants:"uncheck",node:"",others:""}}});
/*
 * tree - jQuery Tree Plugin - collapse component
 *
 * @author Valerio Galano <v.galano@daredevel.com>
 *
 * @license MIT
 *
 * @see http://tree.daredevel.com
 */
$.widget("daredevel.treecollapse",{_create:function(){var a=this;this.element.find("li span."+this.widgetBaseClass+"-anchor").live("click",function(){var b=a.options.core.parentNode($(this));if(b.hasClass("collapsed")){a.expand(b)}else{if(b.hasClass("expanded")){a.collapse(b)}}});this.options.core.collapse=function(b){a.collapse(b)};this.options.core.collapseAll=function(){a.collapseAll()};this.options.core.expand=function(b){a.expand(b)};this.options.core.expandAll=function(){a.expandAll()};this.options.core._treecollapseInitializeNode=function(b){a._initializeNode(b)}},_initializeNode:function(a){var c=this;var b=a.children("span."+this.widgetBaseClass+"-anchor");if(b.length<1){a.prepend($("<span />",{"class":this.widgetBaseClass+"-anchor"}))}if(a.hasClass("leaf")){c._markAsLeaf(a)}else{if(a.hasClass("collapsed")){c.collapse(a,false,true)}else{if(a.hasClass("expanded")){c.expand(a,false,true)}else{if(a.is("li:not(:has(ul))")){c._markAsLeaf(a)}else{c._markAsExpanded(a)}}}}},_markAsCollapsed:function(a){var b=a.children("span."+this.widgetBaseClass+"-anchor");b.removeClass("ui-icon "+this.options.expandUiIcon+" "+this.options.leafUiIcon);if(this.options.collapseUiIcon.length>0){b.addClass("ui-icon "+this.options.collapseUiIcon)}a.removeClass("leaf").removeClass("expanded").addClass("collapsed")},_markAsExpanded:function(a){var b=a.children("span."+this.widgetBaseClass+"-anchor");b.removeClass("ui-icon "+this.options.collapseUiIcon+" "+this.options.leafUiIcon);if(this.options.expandUiIcon.length>0){b.addClass("ui-icon "+this.options.expandUiIcon)}a.removeClass("leaf").removeClass("collapsed").addClass("expanded")},_markAsLeaf:function(a){var b=a.children("span."+this.widgetBaseClass+"-anchor");b.removeClass("ui-icon "+this.options.collapseUiIcon+" "+this.options.expandUiIcon);if(this.options.leafUiIcon.length>0){b.addClass("ui-icon "+this.options.leafUiIcon)}a.removeClass("collapsed").removeClass("expanded").addClass("leaf")},_unmark:function(){li.removeClass("collapsed expanded leaf")},collapse:function(a,c,d){a=$(a);if(d==undefined){d=false}if(!d&&a.hasClass("collapsed")){return}if(c==undefined){c=true}var b=this;if(c){a.children("ul").hide(this.options.collapseEffect,{},this.options.collapseDuration);setTimeout(function(){b._markAsCollapsed(a,b.options)},b.options.collapseDuration)}else{a.children("ul").hide();b._markAsCollapsed(a,b.options)}b.options.core._trigger("collapse",true,a)},collapseAll:function(){var a=this;$(this.element).find("li.expanded").each(function(){a.collapse($(this))})},expand:function(a,c,d){a=$(a);if(d==undefined){d=false}if(!d&&a.hasClass("expanded")){return}if(c==undefined){c=true}var b=this;if(c){a.children("ul").show(b.options.expandEffect,{},b.options.expandDuration);setTimeout(function(){b._markAsExpanded(a,b.options)},b.options.expandDuration)}else{a.children("ul").show();b._markAsExpanded(a,b.options)}b.options.core._trigger("expand",true,a)},expandAll:function(){var a=this;$(this.element).find("li.collapsed").each(function(){a.expand($(this))})},options:{collapseDuration:500,collapseEffect:"blind",collapseUiIcon:"ui-icon-triangle-1-e",expandDuration:500,expandEffect:"blind",expandUiIcon:"ui-icon-triangle-1-se",leafUiIcon:""}});
/*
 * tree - jQuery Tree Plugin - context menu component
 *
 * @author Valerio Galano <v.galano@daredevel.com>
 *
 * @license MIT
 *
 * @see http://tree.daredevel.com
 */
$.widget("daredevel.treecontextmenu",{_buildMenu:function(){var c=this;$("."+this.options.core.widgetBaseClass+"-contextmenu").remove();var b=$("<ul/>",{"class":this.options.core.widgetBaseClass+"-contextmenu"});var a;$.each(this.options.contextmenuItems,function(d,e){a=c._buildMenuItem(e);b.append(a)});b.hide().appendTo(document.body)},_buildMenuItem:function(d){var c=$("<a/>",{html:d.html,href:d.href}).bind("click",d.onClick);var b=$("<li/>",{});return b.append(c)},_closeMenu:function(){$("."+this.options.core.widgetBaseClass+"-contextmenu").remove()},_create:function(){var a=this;this.element.find("."+this.options.core.widgetBaseClass+"-label").live("contextmenu",function(b){a.options.core.select($(this).parent("li"));a._openMenu(b);return false});this.options.core._treecontextmenuInitializeNode=function(b){a._initializeNode(b)}},_destroy:function(){},_initializeNode:function(a){},_openMenu:function(b){var a=this;this._buildMenu();$("."+this.options.core.widgetBaseClass+"-contextmenu").css({left:b.pageX,top:b.pageY}).show();$("body :not(."+this.options.core.widgetBaseClass+"-contextmenu li span)").bind("click",function(){a._closeMenu()})},options:{contextmenuItems:[{html:"move as root",href:"javascript:void(0);",onClick:function(b,a){$(this.options.core.element).tree("moveNode",$("."+this.options.core.widgetBaseClass).selected(),this.options.core.element)}},{html:"cut",href:"javascript:void(0);",onClick:function(b,a){alert("this will cut "+$("."+this.options.core.widgetBaseClass).selected())}},{html:"copy",href:"javascript:void(0);",onClick:function(b,a){alert("a")}},{html:"paste",href:"javascript:void(0);",onClick:function(b,a){alert("b")}}]}});
/*
 * tree - jQuery Tree Plugin - drag and drop component
 *
 * @author Valerio Galano <v.galano@daredevel.com>
 *
 * @license MIT
 *
 * @see http://tree.daredevel.com
 */
$.widget("daredevel.treednd",{_create:function(){var a=this;this.options.core._treedndInitializeNode=function(b){a._initializeNode(b)}},_initializeNode:function(a){var b=this;var c=$("<span/>",{"class":"prepended",html:"<br/>"}).droppable({hoverClass:"over",drop:function(f,g){var e=$(this).closest("li").parent().closest("li");if($(g.draggable.parent("li")).find(e).length){return}var d=$($(this).parent("li")).index()+1;b.options.core.moveNode(g.draggable.parent("li"),e,d);b._trigger("drop",f,{draggable:g.draggable,droppable:e})}});$(a).find("."+this.options.core.widgetBaseClass+"-label:first").after(c);$(a).find("."+this.options.core.widgetBaseClass+"-label:first").draggable({start:function(d,e){$(this).parent("li").find("ul, .prepended").css("visibility","hidden");$(this).parent("li").find(".droppable-label").css("display","none")},stop:function(d,e){$(this).parent("li").find("ul").css("visibility","visible");$(this).parent("li").find(".prepended").css("visibility","");$(this).parent("li").find(".droppable-label").css("display","inherit")},revert:true,revertDuration:0});var c=$("<span/>",{"class":"droppable-label",html:"<br/>"}).droppable({drop:function(e,f){var d=$(this).closest("li");if($(f.draggable.parent("li")).find(d).length){return}b.options.core.moveNode(f.draggable.parent("li"),d,1);b._trigger("drop",e,{draggable:f.draggable,droppable:d})},over:function(d,e){$(this).parent("li").find("."+b.options.core.widgetBaseClass+"-label:first").addClass("ui-state-hover")},out:function(d,e){$(this).parent("li").find("."+b.options.core.widgetBaseClass+"-label:first").removeClass("ui-state-hover")}});$(a).find("."+this.options.core.widgetBaseClass+"-label:first").after(c)},options:{drop:function(b,a){}}});
/*
 * tree - jQuery Tree Plugin
 *
 * @author Valerio Galano <v.galano@daredevel.com>
 *
 * @license MIT
 *
 * @see http://tree.daredevel.com
 *
 * @version 0.1
 */
$.widget("daredevel.tree",{_attachLi:function(b,d,a){var c=d.find("ul:first");if(c.length){if((undefined==a)||(c.children("li").length<a)){c.append(b)}else{if(a==0){a=a+1}c.find("li:nth-child("+a+"):first").before(b)}}else{c=$("<ul/>");d.append(c.append(b))}},_attachNode:function(c,b,a){if(undefined==b){var d=this.options.core.element;this._attachLi(c,d,a);this.options.core._initializeNode(c)}else{var d=b;this._attachLi(c,d,a);d.removeClass("leaf collapsed").addClass("expanded");this.options.core._initializeNode(c);this.options.core._initializeNode(d)}},_buildNode:function(c){c=$.extend(true,this.options.defaultNodeAttributes,c);var d=$("<span/>",c.span);var a=$("<li/>",c.li);if($.inArray("checkbox",this.options.components)>-1){var b=$("<input/>",c.input);a.append(b)}a.append(d);return a},_create:function(){var a=this;this.options.core=this;this.element.addClass("ui-widget ui-widget-content "+this.widgetBaseClass);this._initializeComponents();this.element.find("li").each(function(){a._initializeNode($(this))});if(this.options.nodes!=null){$.each(this.options.nodes,function(b,c){a.options.core.addNode(c)})}},_destroy:function(){$.Widget.prototype.destroy.call(this)},_detachNode:function(b){var a=this.options.core.parentNode(b);var c=a.find("ul:first");if(c.children().length==1){c.detach();a.removeClass("collapsed expanded").addClass("leaf")}else{b.detach()}this.options.core._initializeNode(a)},_initializeComponents:function(){for(var i in this.options.components){var initializeComponent="this.element.tree"+this.options.components[i]+"(this.options)";eval(initializeComponent)}},_initializeNode:function(li){li.children("span:last").addClass(this.options.core.widgetBaseClass+"-label");for(var i in this.options.components){var componentInitializeNode="this._tree"+this.options.components[i]+"InitializeNode(li)";eval(componentInitializeNode)}},addNode:function(d,c,b){var e=this;var a=this._buildNode(d);if((undefined==c)||0==c.length){this._attachNode($(a),undefined,b)}else{this._attachNode($(a),$(c),b)}if(undefined!=d.children){$.each(d.children,function(g,f){e.addNode(g,a)})}e._trigger("add",true,a)},isRoot:function(a){a=$(a);var b=a.parentsUntil("."+this.widgetBaseClass);return 0==b.length},moveNode:function(c,b,a){this._detachNode($(c));if((undefined==b)||0==b.length){this._attachNode($(c),undefined,a)}else{this._attachNode($(c),$(b),a)}this._trigger("move",true,$(c))},parentNode:function(a){return $(a).parents("li:first")},removeNode:function(a){this._detachNode($(a));this._trigger("remove",true,$(a))},options:{components:[],defaultNodeAttributes:{span:{html:"new node"},li:{"class":"leaf"},input:{type:"checkbox"}},nodes:null}});
/*
 * tree - jQuery Tree Plugin - select component
 *
 * @author Valerio Galano <v.galano@daredevel.com>
 *
 * @license MIT
 *
 * @see http://tree.daredevel.com
 */
$.widget("daredevel.treeselect",{_create:function(){var b=this;var a="."+this.options.core.widgetBaseClass+"-label:not(."+this.options.selectUiClass+")";this.element.find(a).live("click",function(){b.select($(this).parent("li"))});this.options.core.deselect=function(c){return b.deselect(c)};this.options.core.select=function(c){return b.select(c)};this.options.core.selected=function(){return b.selected()};this.options.core._treeselectInitializeNode=function(c){b._initializeNode(c)}},_deselect:function(a){a.find("span."+this.options.core.widgetBaseClass+"-label:first").removeClass(this.options.selectUiClass);this._trigger("deselect",true,a)},_destroy:function(){},_initializeNode:function(a){},_select:function(a){a.find("span."+this.options.core.widgetBaseClass+"-label:first").addClass(this.options.selectUiClass);this._trigger("select",true,a)},deselect:function(){var a=this;this.element.find("."+this.options.core.widgetBaseClass+"-label."+this.options.selectUiClass).each(function(){a._deselect($(this).parent("li"))})},select:function(a){a=$(a);var b=this;this.deselect();this._select(a)},selected:function(){var a=this.element.find("."+this.options.core.widgetBaseClass+"-label."+this.options.selectUiClass);return $(a).parent()},options:{deselect:function(b,a){},select:function(b,a){},selectUiClass:"ui-state-active"}});